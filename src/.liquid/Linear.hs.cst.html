<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Linear.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##3982 : GHC.Types.Module | $k_##3983}</span><span class='hs-keyword'>module</span></a> <span class='hs-conid'>Linear</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 2: </span>
<span class=hs-linenum> 3: </span><span class='hs-comment'>--will need to make these proper data types, but the synatax is so clean this way...</span>
<span class=hs-linenum> 4: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 6: </span>
<span class=hs-linenum> 7: </span><span class='hs-comment'>-- class Tensor a where</span>
<span class=hs-linenum> 8: </span>
<span class=hs-linenum> 9: </span><span class='hs-definition'>dot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>10: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Num.Num&lt;[]&gt; a) =&gt;
lq_tmp$x##764:[a] -&gt; lq_tmp$x##765:[a] -&gt; a</span><span class='hs-definition'>dot</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sum</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##802 : [{lq_tmp$x##824 : a | $k_##823[VV##822:=lq_tmp$x##824][lq_tmp$x##810:=lq_anf$##7205759403792805327##d339][lq_tmp$x##811:=x##a1y4][lq_tmp$x##812:=y##a1y5]}] | len lq_tmp$x##802 &lt;= len x##a1y4
                                                                                                                                                                               &amp;&amp; len lq_tmp$x##802 &lt;= len y##a1y5}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>zipWith</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##780:a -&gt; lq_tmp$x##781:a -&gt; {lq_tmp$x##782 : a | lq_tmp$x##782 == lq_tmp$x##780 * lq_tmp$x##781}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>*</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##835 : [a] | len lq_tmp$x##835 &gt;= 0
                       &amp;&amp; lq_tmp$x##835 == x##a1y4}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##840 : [a] | len lq_tmp$x##840 &gt;= 0
                       &amp;&amp; lq_tmp$x##840 == y##a1y5}</span><span class='hs-varid'>y</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>11: </span>
<span class=hs-linenum>12: </span><span class='hs-definition'>add</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>13: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Num.Num&lt;[]&gt; a) =&gt;
lq_tmp$x##878:[a] -&gt; lq_tmp$x##879:[a] -&gt; [a]</span><span class='hs-definition'>add</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>zipWith</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##895:a -&gt; lq_tmp$x##896:a -&gt; {lq_tmp$x##897 : a | lq_tmp$x##897 == lq_tmp$x##895 + lq_tmp$x##896}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##950 : [a] | len lq_tmp$x##950 &gt;= 0
                       &amp;&amp; lq_tmp$x##950 == x##a1y6}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##955 : [a] | len lq_tmp$x##955 &gt;= 0
                       &amp;&amp; lq_tmp$x##955 == y##a1y7}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>14: </span>
<span class=hs-linenum>15: </span><span class='hs-definition'>subtract</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>16: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Num.Num&lt;[]&gt; a) =&gt;
lq_tmp$x##964:[a] -&gt; lq_tmp$x##965:[a] -&gt; [a]</span><span class='hs-definition'>subtract</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>zipWith</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##981:a -&gt; lq_tmp$x##982:a -&gt; {lq_tmp$x##983 : a | lq_tmp$x##983 == lq_tmp$x##981 - lq_tmp$x##982}</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1036 : [a] | len lq_tmp$x##1036 &gt;= 0
                        &amp;&amp; lq_tmp$x##1036 == x##a1y8}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1041 : [a] | len lq_tmp$x##1041 &gt;= 0
                        &amp;&amp; lq_tmp$x##1041 == y##a1y9}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>17: </span>
<span class=hs-linenum>18: </span><span class='hs-definition'>scale</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>19: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Num.Num&lt;[]&gt; a) =&gt;
lq_tmp$x##1049:[a] -&gt; lq_tmp$x##1050:a -&gt; [a]</span><span class='hs-definition'>scale</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1066:a -&gt; {lq_tmp$x##1067 : a | lq_tmp$x##1067 == c##a1yb * lq_tmp$x##1066}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1070 : a | lq_tmp$x##1070 == c##a1yb}</span><span class='hs-varid'>c</span></a> <span class='hs-varop'>*</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1104 : [a] | len lq_tmp$x##1104 &gt;= 0
                        &amp;&amp; lq_tmp$x##1104 == x##a1ya}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-definition'>row</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>22: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1113:[[a]] -&gt; lq_tmp$x##1114:GHC.Types.Int -&gt; [a]</span><span class='hs-definition'>row</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>i</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1153 : [[a]] | len lq_tmp$x##1153 &gt;= 0
                          &amp;&amp; lq_tmp$x##1153 == x##a1yc}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>!!</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{lq_tmp$x##1157 : GHC.Types.Int | lq_tmp$x##1157 == i##a1yd}</span><span class='hs-varid'>i</span></a></span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-definition'>column</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>25: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1163:[[a]] -&gt; lq_tmp$x##1164:GHC.Types.Int -&gt; [a]</span><span class='hs-definition'>column</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>j</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1193 : a | $k_##1192[VV##1191:=lq_tmp$x##1193][lq_tmp$x##1188:=ds_d32y][lq_tmp$x##1189:=j##a1yf]}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>!!</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{lq_tmp$x##1199 : GHC.Types.Int | lq_tmp$x##1199 == j##a1yf}</span><span class='hs-varid'>j</span></a></span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1252 : [[a]] | len lq_tmp$x##1252 &gt;= 0
                          &amp;&amp; lq_tmp$x##1252 == x##a1ye}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>26: </span>
<span class=hs-linenum>27: </span><span class='hs-definition'>getValue</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>28: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1261:[[a]] -&gt; lq_tmp$x##1262:GHC.Types.Int -&gt; lq_tmp$x##1263:GHC.Types.Int -&gt; a</span><span class='hs-definition'>getValue</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>j</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1292 : [{lq_tmp$x##1289 : a | $k_##1283[VV##1282:=lq_tmp$x##1289][VV##1287:=lq_tmp$x##1292][lq_tmp$x##1279:=x##a1yg][lq_tmp$x##1280:=i##a1yh]}]&lt;\lq_tmp$x##1290 VV -&gt; {lq_tmp$x##1291 : a | $k_##1286[VV##1285:=lq_tmp$x##1291][VV##1287:=lq_tmp$x##1292][lq_tmp$x##1279:=x##a1yg][lq_tmp$x##1280:=i##a1yh][lq_tmp$x##1284:=lq_tmp$x##1290]}&gt; | $k_##1288[VV##1287:=lq_tmp$x##1292][lq_tmp$x##1279:=x##a1yg][lq_tmp$x##1280:=i##a1yh]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1302 : [[a]] | len lq_tmp$x##1302 &gt;= 0
                          &amp;&amp; lq_tmp$x##1302 == x##a1yg}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>!!</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{lq_tmp$x##1306 : GHC.Types.Int | lq_tmp$x##1306 == i##a1yh}</span><span class='hs-varid'>i</span></a></span><span class='hs-layout'>)</span> <span class='hs-varop'>!!</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{lq_tmp$x##1328 : GHC.Types.Int | lq_tmp$x##1328 == j##a1yi}</span><span class='hs-varid'>j</span></a></span>
<span class=hs-linenum>29: </span>
<span class=hs-linenum>30: </span><span class='hs-definition'>setValue</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>31: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1490:[[a]] -&gt; lq_tmp$x##1491:GHC.Types.Int -&gt; lq_tmp$x##1492:GHC.Types.Int -&gt; lq_tmp$x##1493:a -&gt; [[a]]</span><span class='hs-definition'>setValue</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>j</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>replace</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1608 : GHC.Types.Int | lq_tmp$x##1608 == i##a1yk}</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>[{lq_tmp$x##1569 : a | $k_##1568[VV##1567:=lq_tmp$x##1569][lq_tmp$x##1562:=j##a1yl][lq_tmp$x##1563:=a##a1ym][lq_tmp$x##1564:=lq_anf$##7205759403792805340##d33m]}]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>replace</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1570 : GHC.Types.Int | lq_tmp$x##1570 == j##a1yl}</span><span class='hs-varid'>j</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1571 : a | lq_tmp$x##1571 == a##a1ym}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>[{lq_tmp$x##1532 : a | $k_##1531[VV##1530:=lq_tmp$x##1532][lq_tmp$x##1524:=x##a1yj][lq_tmp$x##1525:=i##a1yk]}]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>row</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1542 : [[a]] | len lq_tmp$x##1542 &gt;= 0
                          &amp;&amp; lq_tmp$x##1542 == x##a1yj}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1546 : GHC.Types.Int | lq_tmp$x##1546 == i##a1yk}</span><span class='hs-varid'>i</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1623 : [[a]] | len lq_tmp$x##1623 &gt;= 0
                          &amp;&amp; lq_tmp$x##1623 == x##a1yj}</span><span class='hs-varid'>x</span></a> 
<span class=hs-linenum>32: </span>
<span class=hs-linenum>33: </span><span class='hs-definition'>replace</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>34: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1334:GHC.Types.Int -&gt; lq_tmp$x##1335:a -&gt; lq_tmp$x##1336:[a] -&gt; [a]</span><span class='hs-definition'>replace</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>pos</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>newVal</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>list</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1350 : [{lq_tmp$x##1360 : a | $k_##1359[VV##1358:=lq_tmp$x##1360][lq_tmp$x##1354:=pos##a1yn][lq_tmp$x##1355:=list##a1yp]}] | (pos##a1yn &gt;= 0 =&gt; len lq_tmp$x##1350 == (if len list##a1yp &lt; pos##a1yn then len list##a1yp else pos##a1yn))
                                                                                                                                        &amp;&amp; (not (pos##a1yn &gt;= 0) =&gt; len lq_tmp$x##1350 == 0)}</span><span class='hs-varid'>take</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1361 : GHC.Types.Int | lq_tmp$x##1361 == pos##a1yn}</span><span class='hs-varid'>pos</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1365 : [a] | len lq_tmp$x##1365 &gt;= 0
                        &amp;&amp; lq_tmp$x##1365 == list##a1yp}</span><span class='hs-varid'>list</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1442 : a | lq_tmp$x##1442 == newVal##a1yo}</span><span class='hs-varid'>newVal</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1401 : [{lq_tmp$x##1411 : a | $k_##1410[VV##1409:=lq_tmp$x##1411][lq_tmp$x##1405:=lq_anf$##7205759403792805337##d33j][lq_tmp$x##1406:=list##a1yp]}] | (lq_anf$##7205759403792805337##d33j &gt;= 0 =&gt; len lq_tmp$x##1401 == (if len list##a1yp &lt; lq_anf$##7205759403792805337##d33j then 0 else len list##a1yp - lq_anf$##7205759403792805337##d33j))
                                                                                                                                                                 &amp;&amp; (not (lq_anf$##7205759403792805337##d33j &gt;= 0) =&gt; len lq_tmp$x##1401 == len list##a1yp)}</span><span class='hs-varid'>drop</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1387 : GHC.Types.Int | lq_tmp$x##1387 == pos##a1yn + lq_anf$##7205759403792805336##d33i}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1390 : GHC.Types.Int | lq_tmp$x##1390 == pos##a1yn}</span><span class='hs-varid'>pos</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1371 : GHC.Types.Int | lq_tmp$x##1371 == lq_anf$##7205759403792805335##d33h}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1416 : [a] | len lq_tmp$x##1416 &gt;= 0
                        &amp;&amp; lq_tmp$x##1416 == list##a1yp}</span><span class='hs-varid'>list</span></a>
<span class=hs-linenum>35: </span>
<span class=hs-linenum>36: </span><span class='hs-definition'>transpose</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>37: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##2246:[[a]] -&gt; [[a]]</span><span class='hs-definition'>transpose</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2275:GHC.Types.Int -&gt; [{lq_tmp$x##2282 : a | $k_##2281[VV##2280:=lq_tmp$x##2282][lq_tmp$x##2274:=x##a1yq]}]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>column</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2292 : [[a]] | len lq_tmp$x##2292 &gt;= 0
                          &amp;&amp; lq_tmp$x##2292 == x##a1yq}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2300 : GHC.Types.Int | lq_tmp$x##2300 == lq_anf$##7205759403792805358##d33E}</span><span class='hs-num'>0</span></a><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2429 : GHC.Types.Int | lq_tmp$x##2429 == lq_anf$##7205759403792805362##d33I - lq_anf$##7205759403792805364##d33K}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2392 : GHC.Types.Int | $k_##2391[VV##2390:=lq_tmp$x##2392][lq_tmp$x##2371:=lq_anf$##7205759403792805360##d33G][lq_tmp$x##2372:=lq_anf$##7205759403792805361##d33H]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a##a6fh b##a6fi .
      lq_tmp$x##2313:(a##a6fh, b##a6fi) -&gt; {lq_tmp$x##2310 : b##a6fi | lq_tmp$x##2310 == snd lq_tmp$x##2313} | VV == Data.Tuple.snd}</span><span class='hs-varid'>snd</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>dimensions</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2358 : [[a]] | len lq_tmp$x##2358 &gt;= 0
                          &amp;&amp; lq_tmp$x##2358 == x##a1yq}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2413 : GHC.Types.Int | lq_tmp$x##2413 == lq_anf$##7205759403792805363##d33J}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>38: </span>
<span class=hs-linenum>39: </span><span class='hs-definition'>dimensions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<span class=hs-linenum>40: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##1637:[[a]] -&gt; (GHC.Types.Int, GHC.Types.Int)</span><span class='hs-definition'>dimensions</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1648 : GHC.Types.Int | lq_tmp$x##1648 &gt;= 0
                                  &amp;&amp; lq_tmp$x##1648 == len x##a1yr}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1680 : [[a]] | len lq_tmp$x##1680 &gt;= 0
                          &amp;&amp; lq_tmp$x##1680 == x##a1yr}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1736 : GHC.Types.Int | lq_tmp$x##1736 &gt;= 0
                                  &amp;&amp; lq_tmp$x##1736 == len lq_anf$##7205759403792805345##d33r}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1715 : [{lq_tmp$x##1712 : a | $k_##1706[VV##1705:=lq_tmp$x##1712][VV##1710:=lq_tmp$x##1715][lq_tmp$x##1702:=x##a1yr][lq_tmp$x##1703:=lq_anf$##7205759403792805344##d33q]}]&lt;\lq_tmp$x##1713 VV -&gt; {lq_tmp$x##1714 : a | $k_##1709[VV##1708:=lq_tmp$x##1714][VV##1710:=lq_tmp$x##1715][lq_tmp$x##1702:=x##a1yr][lq_tmp$x##1703:=lq_anf$##7205759403792805344##d33q][lq_tmp$x##1707:=lq_tmp$x##1713]}&gt; | $k_##1711[VV##1710:=lq_tmp$x##1715][lq_tmp$x##1702:=x##a1yr][lq_tmp$x##1703:=lq_anf$##7205759403792805344##d33q]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1725 : [[a]] | len lq_tmp$x##1725 &gt;= 0
                          &amp;&amp; lq_tmp$x##1725 == x##a1yr}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>!!</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{lq_tmp$x##1688 : GHC.Types.Int | lq_tmp$x##1688 == lq_anf$##7205759403792805343##d33p}</span><span class='hs-num'>0</span></a></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>41: </span>
<span class=hs-linenum>42: </span><span class='hs-definition'>dimension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>43: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##1785:[[a]] -&gt; GHC.Types.Int</span><span class='hs-definition'>dimension</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1877 : GHC.Types.Int | $k_##1876[VV##1875:=lq_tmp$x##1877][lq_tmp$x##1856:=lq_anf$##7205759403792805347##d33t][lq_tmp$x##1857:=lq_anf$##7205759403792805348##d33u]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a##a6ff b##a6fg .
      lq_tmp$x##1798:(a##a6ff, b##a6fg) -&gt; {lq_tmp$x##1795 : a##a6ff | lq_tmp$x##1795 == fst lq_tmp$x##1798} | VV == Data.Tuple.fst}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>dimensions</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1843 : [[a]] | len lq_tmp$x##1843 &gt;= 0
                          &amp;&amp; lq_tmp$x##1843 == x##a1ys}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1982 : GHC.Types.Int | $k_##1981[VV##1980:=lq_tmp$x##1982][lq_tmp$x##1961:=lq_anf$##7205759403792805350##d33w][lq_tmp$x##1962:=lq_anf$##7205759403792805351##d33x]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a##a6fh b##a6fi .
      lq_tmp$x##1903:(a##a6fh, b##a6fi) -&gt; {lq_tmp$x##1900 : b##a6fi | lq_tmp$x##1900 == snd lq_tmp$x##1903} | VV == Data.Tuple.snd}</span><span class='hs-varid'>snd</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>dimensions</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1948 : [[a]] | len lq_tmp$x##1948 &gt;= 0
                          &amp;&amp; lq_tmp$x##1948 == x##a1ys}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>44: </span>
<span class=hs-linenum>45: </span><span class='hs-definition'>rows</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>46: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##2020:[[a]] -&gt; GHC.Types.Int</span><span class='hs-definition'>rows</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a6ff b##a6fg .
      lq_tmp$x##2033:(a##a6ff, b##a6fg) -&gt; {lq_tmp$x##2030 : a##a6ff | lq_tmp$x##2030 == fst lq_tmp$x##2033} | VV == Data.Tuple.fst}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>dimensions</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2078 : [[a]] | len lq_tmp$x##2078 &gt;= 0
                          &amp;&amp; lq_tmp$x##2078 == x##a1yt}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>47: </span>
<span class=hs-linenum>48: </span><span class='hs-definition'>columns</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>49: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##2133:[[a]] -&gt; GHC.Types.Int</span><span class='hs-definition'>columns</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a6fh b##a6fi .
      lq_tmp$x##2146:(a##a6fh, b##a6fi) -&gt; {lq_tmp$x##2143 : b##a6fi | lq_tmp$x##2143 == snd lq_tmp$x##2146} | VV == Data.Tuple.snd}</span><span class='hs-varid'>snd</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>dimensions</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2191 : [[a]] | len lq_tmp$x##2191 &gt;= 0
                          &amp;&amp; lq_tmp$x##2191 == x##a1yu}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>50: </span>
<span class=hs-linenum>51: </span><span class='hs-definition'>multiply</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>52: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Num.Num&lt;[]&gt; a) =&gt;
lq_tmp$x##3204:[[a]] -&gt; lq_tmp$x##3205:[[a]] -&gt; [[a]]</span><span class='hs-definition'>multiply</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##3774:GHC.Types.Int -&gt; lq_tmp$x##3775:[a] -&gt; [[a]] | VV == Linear.group}</span><span class='hs-varid'>group</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3783 : GHC.Types.Int | lq_tmp$x##3783 == p##a1yy}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3787 : [{lq_tmp$x##3784 : a | $k_##3236[VV##3235:=lq_tmp$x##3784][VV##3240:=lq_tmp$x##3787][ds_d332:=x##a1yv][lq_tmp$x##3245:=x##a1yv][lq_tmp$x##3693:=lq_tmp$x##3784][lq_tmp$x##3696:=lq_tmp$x##3787][lq_tmp$x##3701:=x##a1yv]}]&lt;\lq_tmp$x##3788 VV -&gt; {lq_tmp$x##3786 : a | $k_##3239[VV##3238:=lq_tmp$x##3786][VV##3240:=lq_tmp$x##3787][ds_d332:=x##a1yv][lq_tmp$x##3237:=lq_tmp$x##3788][lq_tmp$x##3245:=x##a1yv][lq_tmp$x##3249:=lq_tmp$x##3788][lq_tmp$x##3694:=lq_tmp$x##3788][lq_tmp$x##3695:=lq_tmp$x##3786][lq_tmp$x##3696:=lq_tmp$x##3787][lq_tmp$x##3701:=x##a1yv][lq_tmp$x##3705:=lq_tmp$x##3788][lq_tmp$x##3785:=lq_tmp$x##3788]}&gt; | $k_##3241[VV##3240:=lq_tmp$x##3787][ds_d332:=x##a1yv][lq_tmp$x##3245:=x##a1yv][lq_tmp$x##3696:=lq_tmp$x##3787][lq_tmp$x##3701:=x##a1yv]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; len lq_tmp$x##3787 &gt;= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; lq_tmp$x##3787 == products##a1yz}</span><span class='hs-varid'>products</span></a> <span class='hs-keyword'>where</span>
<span class=hs-linenum>53: </span>    <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rows</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>54: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>p</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>columns</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3751 : [[a]] | len lq_tmp$x##3751 &gt;= 0
                          &amp;&amp; lq_tmp$x##3751 == y##a1yw}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>55: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##3696 : [{lq_tmp$x##3693 : a | $k_##3236[VV##3235:=lq_tmp$x##3693][VV##3240:=lq_tmp$x##3696][ds_d332:=x##a1yv][lq_tmp$x##3245:=x##a1yv][lq_tmp$x##3701:=x##a1yv]}]&lt;\lq_tmp$x##3705 VV -&gt; {lq_tmp$x##3695 : a | $k_##3239[VV##3238:=lq_tmp$x##3695][VV##3240:=lq_tmp$x##3696][ds_d332:=x##a1yv][lq_tmp$x##3237:=lq_tmp$x##3705][lq_tmp$x##3245:=x##a1yv][lq_tmp$x##3249:=lq_tmp$x##3705][lq_tmp$x##3694:=lq_tmp$x##3705][lq_tmp$x##3701:=x##a1yv]}&gt; | $k_##3241[VV##3240:=lq_tmp$x##3696][ds_d332:=x##a1yv][lq_tmp$x##3245:=x##a1yv][lq_tmp$x##3701:=x##a1yv]}</span><span class='hs-varid'>products</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3546 : [{lq_tmp$x##3543 : a | $k_##3364[VV##3363:=lq_tmp$x##3543][VV##3368:=lq_tmp$x##3546][ds_d336:=ds_d338][lq_tmp$x##3373:=ds_d338][lq_tmp$x##3551:=ds_d338]}]&lt;\lq_tmp$x##3555 VV -&gt; {lq_tmp$x##3545 : a | $k_##3367[VV##3366:=lq_tmp$x##3545][VV##3368:=lq_tmp$x##3546][ds_d336:=ds_d338][lq_tmp$x##3365:=lq_tmp$x##3555][lq_tmp$x##3373:=ds_d338][lq_tmp$x##3377:=lq_tmp$x##3555][lq_tmp$x##3544:=lq_tmp$x##3555][lq_tmp$x##3551:=ds_d338]}&gt; | $k_##3369[VV##3368:=lq_tmp$x##3546][ds_d336:=ds_d338][lq_tmp$x##3373:=ds_d338][lq_tmp$x##3551:=ds_d338]}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>dot</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3525 : [{lq_tmp$x##3522 : a | $k_##3219[VV##3218:=lq_tmp$x##3522][VV##3223:=lq_tmp$x##3525][VV##3233:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3252:=lq_tmp$x##3522][lq_tmp$x##3255:=lq_tmp$x##3525][lq_tmp$x##3261:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3302:=lq_tmp$x##3522][lq_tmp$x##3305:=lq_tmp$x##3525][lq_tmp$x##3311:=lq_anf$##7205759403792805386##d346]}]&lt;\lq_tmp$x##3526 VV -&gt; {lq_tmp$x##3524 : a | $k_##3222[VV##3221:=lq_tmp$x##3524][VV##3223:=lq_tmp$x##3525][VV##3233:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3220:=lq_tmp$x##3526][lq_tmp$x##3242:=lq_tmp$x##3526][lq_tmp$x##3246:=lq_tmp$x##3526][lq_tmp$x##3253:=lq_tmp$x##3526][lq_tmp$x##3254:=lq_tmp$x##3524][lq_tmp$x##3255:=lq_tmp$x##3525][lq_tmp$x##3261:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3262:=lq_tmp$x##3526][lq_tmp$x##3303:=lq_tmp$x##3526][lq_tmp$x##3304:=lq_tmp$x##3524][lq_tmp$x##3305:=lq_tmp$x##3525][lq_tmp$x##3311:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3312:=lq_tmp$x##3526][lq_tmp$x##3523:=lq_tmp$x##3526]}&gt; | $k_##3224[VV##3223:=lq_tmp$x##3525][VV##3233:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3255:=lq_tmp$x##3525][lq_tmp$x##3261:=lq_anf$##7205759403792805386##d346][lq_tmp$x##3305:=lq_tmp$x##3525][lq_tmp$x##3311:=lq_anf$##7205759403792805386##d346]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##3525 &gt;= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; lq_tmp$x##3525 == ds_d333}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3530 : [{lq_tmp$x##3527 : a | $k_##3347[VV##3346:=lq_tmp$x##3527][VV##3351:=lq_tmp$x##3530][VV##3361:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3380:=lq_tmp$x##3527][lq_tmp$x##3383:=lq_tmp$x##3530][lq_tmp$x##3389:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3454:=lq_tmp$x##3527][lq_tmp$x##3457:=lq_tmp$x##3530][lq_tmp$x##3463:=lq_anf$##7205759403792805387##d347]}]&lt;\lq_tmp$x##3531 VV -&gt; {lq_tmp$x##3529 : a | $k_##3350[VV##3349:=lq_tmp$x##3529][VV##3351:=lq_tmp$x##3530][VV##3361:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3348:=lq_tmp$x##3531][lq_tmp$x##3370:=lq_tmp$x##3531][lq_tmp$x##3374:=lq_tmp$x##3531][lq_tmp$x##3381:=lq_tmp$x##3531][lq_tmp$x##3382:=lq_tmp$x##3529][lq_tmp$x##3383:=lq_tmp$x##3530][lq_tmp$x##3389:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3390:=lq_tmp$x##3531][lq_tmp$x##3455:=lq_tmp$x##3531][lq_tmp$x##3456:=lq_tmp$x##3529][lq_tmp$x##3457:=lq_tmp$x##3530][lq_tmp$x##3463:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3464:=lq_tmp$x##3531][lq_tmp$x##3528:=lq_tmp$x##3531]}&gt; | $k_##3352[VV##3351:=lq_tmp$x##3530][VV##3361:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3383:=lq_tmp$x##3530][lq_tmp$x##3389:=lq_anf$##7205759403792805387##d347][lq_tmp$x##3457:=lq_tmp$x##3530][lq_tmp$x##3463:=lq_anf$##7205759403792805387##d347]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##3530 &gt;= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; lq_tmp$x##3530 == ds_d337}</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3715 : [[a]] | len lq_tmp$x##3715 &gt;= 0
                          &amp;&amp; lq_tmp$x##3715 == x##a1yv}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[[{lq_tmp$x##3632 : a | $k_##3631[VV##3630:=lq_tmp$x##3632][lq_tmp$x##3623:=y##a1yw]}]]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>transpose</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3642 : [[a]] | len lq_tmp$x##3642 &gt;= 0
                          &amp;&amp; lq_tmp$x##3642 == y##a1yw}</span><span class='hs-varid'>y</span></a><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>56: </span>
<span class=hs-linenum>57: </span><span class='hs-definition'>group</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>58: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2511:GHC.Types.Int -&gt; lq_tmp$x##2512:[a] -&gt; [[a]]</span><span class='hs-definition'>group</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##2545 : [a]&lt;\lq_tmp$x##2546 VV -&gt; {lq_tmp$x##2544 : a&lt;p lq_tmp$x##2546&gt; | true}&gt; | len lq_tmp$x##2545 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>59: </span><span class='hs-definition'>group</span> <span class='hs-varid'>n</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2611 : [{lq_tmp$x##2621 : a | $k_##2620[VV##2619:=lq_tmp$x##2621][lq_tmp$x##2615:=ds_d317][lq_tmp$x##2616:=ds_d318]}] | (ds_d317 &gt;= 0 =&gt; len lq_tmp$x##2611 == (if len ds_d318 &lt; ds_d317 then len ds_d318 else ds_d317))
                                                                                                                                   &amp;&amp; (not (ds_d317 &gt;= 0) =&gt; len lq_tmp$x##2611 == 0)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>take</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2622 : GHC.Types.Int | lq_tmp$x##2622 == ds_d317}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2626 : [a] | len lq_tmp$x##2626 &gt;= 0
                        &amp;&amp; lq_tmp$x##2626 == ds_d318}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>[[{lq_tmp$x##2681 : a | $k_##2680[VV##2679:=lq_tmp$x##2681][lq_tmp$x##2511:=ds_d317][lq_tmp$x##2512:=lq_anf$##7205759403792805369##d33P]}]]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>group</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{lq_tmp$x##2682 : GHC.Types.Int | lq_tmp$x##2682 == ds_d317}</span><span class='hs-varid'>n</span></a></span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2637 : [{lq_tmp$x##2647 : a | $k_##2646[VV##2645:=lq_tmp$x##2647][lq_tmp$x##2641:=ds_d317][lq_tmp$x##2642:=ds_d318]}] | (ds_d317 &gt;= 0 =&gt; len lq_tmp$x##2637 == (if len ds_d318 &lt; ds_d317 then 0 else len ds_d318 - ds_d317))
                                                                                                                                   &amp;&amp; (not (ds_d317 &gt;= 0) =&gt; len lq_tmp$x##2637 == len ds_d318)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>drop</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2648 : GHC.Types.Int | lq_tmp$x##2648 == ds_d317}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2652 : [a] | len lq_tmp$x##2652 &gt;= 0
                        &amp;&amp; lq_tmp$x##2652 == ds_d318}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>60: </span>
<span class=hs-linenum>61: </span><span class='hs-definition'>show_matrix</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>62: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Show.Show&lt;[]&gt; a) =&gt;
lq_tmp$x##3797:[[a]] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>show_matrix</span></a> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-varid'>m</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapM_</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3965:[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3850 : [{lq_tmp$x##3880 : [{lq_tmp$x##3877 : GHC.Types.Char | $k_##3871[VV##3870:=lq_tmp$x##3877][VV##3875:=lq_tmp$x##3880][lq_tmp$x##3855:=lq_anf$##7205759403792805394##d34e][lq_tmp$x##3856:=m##a1yE]}]&lt;\lq_tmp$x##3878 VV -&gt; {lq_tmp$x##3879 : GHC.Types.Char | $k_##3874[VV##3873:=lq_tmp$x##3879][VV##3875:=lq_tmp$x##3880][lq_tmp$x##3855:=lq_anf$##7205759403792805394##d34e][lq_tmp$x##3856:=m##a1yE][lq_tmp$x##3872:=lq_tmp$x##3878]}&gt; | $k_##3876[VV##3875:=lq_tmp$x##3880][lq_tmp$x##3855:=lq_anf$##7205759403792805394##d34e][lq_tmp$x##3856:=m##a1yE]}] | len lq_tmp$x##3850 == len m##a1yE}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3827:[a] -&gt; [GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3903 : [[a]] | len lq_tmp$x##3903 &gt;= 0
                          &amp;&amp; lq_tmp$x##3903 == m##a1yE}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>63: </span>
<span class=hs-linenum>64: </span><span class='hs-definition'>generate_matrix</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Matrix</span> <span class='hs-conid'>Float</span>
<span class=hs-linenum>65: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2744:GHC.Types.Int -&gt; lq_tmp$x##2745:GHC.Types.Int -&gt; lq_tmp$x##2746:GHC.Types.Float -&gt; [[GHC.Types.Float]]</span><span class='hs-definition'>generate_matrix</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Float</span><span class='hs-varid'>z</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##3178:GHC.Types.Int -&gt; lq_tmp$x##3179:[a] -&gt; [[a]] | VV == Linear.group}</span><span class='hs-varid'>group</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3187 : GHC.Types.Int | lq_tmp$x##3187 == y##a1yG}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3191 : [{lq_tmp$x##3188 : GHC.Types.Float | $k_##2761[VV##2760:=lq_tmp$x##3188][VV##2765:=lq_tmp$x##3191][ds_d31L:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2768:=lq_anf$##7205759403792805385##d345][lq_tmp$x##3145:=lq_tmp$x##3188][lq_tmp$x##3148:=lq_tmp$x##3191][lq_tmp$x##3151:=lq_anf$##7205759403792805385##d345]}]&lt;\lq_tmp$x##3192 VV -&gt; {lq_tmp$x##3190 : GHC.Types.Float | $k_##2764[VV##2763:=lq_tmp$x##3190][VV##2765:=lq_tmp$x##3191][ds_d31L:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2762:=lq_tmp$x##3192][lq_tmp$x##2768:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2770:=lq_tmp$x##3192][lq_tmp$x##3146:=lq_tmp$x##3192][lq_tmp$x##3147:=lq_tmp$x##3190][lq_tmp$x##3148:=lq_tmp$x##3191][lq_tmp$x##3151:=lq_anf$##7205759403792805385##d345][lq_tmp$x##3153:=lq_tmp$x##3192][lq_tmp$x##3189:=lq_tmp$x##3192]}&gt; | $k_##2766[VV##2765:=lq_tmp$x##3191][ds_d31L:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2768:=lq_anf$##7205759403792805385##d345][lq_tmp$x##3148:=lq_tmp$x##3191][lq_tmp$x##3151:=lq_anf$##7205759403792805385##d345]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; len lq_tmp$x##3191 &gt;= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; lq_tmp$x##3191 == values##a1yI}</span><span class='hs-varid'>values</span></a> <span class='hs-keyword'>where</span>
<span class=hs-linenum>66: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##3148 : [{lq_tmp$x##3145 : GHC.Types.Float | $k_##2761[VV##2760:=lq_tmp$x##3145][VV##2765:=lq_tmp$x##3148][ds_d31L:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2768:=lq_anf$##7205759403792805385##d345][lq_tmp$x##3151:=lq_anf$##7205759403792805385##d345]}]&lt;\lq_tmp$x##3153 VV -&gt; {lq_tmp$x##3147 : GHC.Types.Float | $k_##2764[VV##2763:=lq_tmp$x##3147][VV##2765:=lq_tmp$x##3148][ds_d31L:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2762:=lq_tmp$x##3153][lq_tmp$x##2768:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2770:=lq_tmp$x##3153][lq_tmp$x##3146:=lq_tmp$x##3153][lq_tmp$x##3151:=lq_anf$##7205759403792805385##d345]}&gt; | $k_##2766[VV##2765:=lq_tmp$x##3148][ds_d31L:=lq_anf$##7205759403792805385##d345][lq_tmp$x##2768:=lq_anf$##7205759403792805385##d345][lq_tmp$x##3151:=lq_anf$##7205759403792805385##d345]}</span><span class='hs-varid'>values</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3024 : [{lq_tmp$x##3021 : GHC.Types.Float | $k_##2851[VV##2850:=lq_tmp$x##3021][VV##2855:=lq_tmp$x##3024][ds_d31P:=ds_d31R][lq_tmp$x##2858:=ds_d31R][lq_tmp$x##3027:=ds_d31R]}]&lt;\lq_tmp$x##3029 VV -&gt; {lq_tmp$x##3023 : GHC.Types.Float | $k_##2854[VV##2853:=lq_tmp$x##3023][VV##2855:=lq_tmp$x##3024][ds_d31P:=ds_d31R][lq_tmp$x##2852:=lq_tmp$x##3029][lq_tmp$x##2858:=ds_d31R][lq_tmp$x##2860:=lq_tmp$x##3029][lq_tmp$x##3022:=lq_tmp$x##3029][lq_tmp$x##3027:=ds_d31R]}&gt; | $k_##2856[VV##2855:=lq_tmp$x##3024][ds_d31P:=ds_d31R][lq_tmp$x##2858:=ds_d31R][lq_tmp$x##3027:=ds_d31R]}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3014 : GHC.Types.Float | lq_tmp$x##3014 == z##a1yH}</span><span class='hs-varid'>z</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2993 : GHC.Types.Float | $k_##2992[VV##2991:=lq_tmp$x##2993][lq_tmp$x##2983:=lq_anf$##7205759403792805375##d33V][lq_tmp$x##2984:=lq_anf$##7205759403792805376##d33W]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2950:GHC.Types.Int -&gt; {lq_tmp$x##2952 : GHC.Types.Float | lq_tmp$x##2952 == lq_tmp$x##2950}</span><span class='hs-varid'>fromIntegral</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2972 : GHC.Types.Int | $k_##2754[VV##2753:=lq_tmp$x##2972][VV##2758:=lq_anf$##7205759403792805373##d33T][lq_tmp$x##2773:=lq_tmp$x##2972][lq_tmp$x##2776:=lq_anf$##7205759403792805373##d33T][lq_tmp$x##2807:=lq_tmp$x##2972][lq_tmp$x##2810:=lq_anf$##7205759403792805373##d33T]
                                  &amp;&amp; lq_tmp$x##2972 == ds_d31M}</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2973 : GHC.Types.Int | $k_##2844[VV##2843:=lq_tmp$x##2973][VV##2848:=lq_anf$##7205759403792805374##d33U][lq_tmp$x##2863:=lq_tmp$x##2973][lq_tmp$x##2866:=lq_anf$##7205759403792805374##d33U][lq_tmp$x##2903:=lq_tmp$x##2973][lq_tmp$x##2906:=lq_anf$##7205759403792805374##d33U]
                                  &amp;&amp; lq_tmp$x##2973 == ds_d31Q}</span><span class='hs-varid'>w</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3115 : GHC.Types.Int | lq_tmp$x##3115 == lq_anf$##7205759403792805383##d343}</span><span class='hs-num'>1</span></a><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3139 : GHC.Types.Int | lq_tmp$x##3139 == x##a1yF}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3068 : GHC.Types.Int | lq_tmp$x##3068 == lq_anf$##7205759403792805380##d340}</span><span class='hs-num'>1</span></a><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3092 : GHC.Types.Int | lq_tmp$x##3092 == y##a1yG}</span><span class='hs-varid'>y</span></a><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span></pre>
</body>
</html>